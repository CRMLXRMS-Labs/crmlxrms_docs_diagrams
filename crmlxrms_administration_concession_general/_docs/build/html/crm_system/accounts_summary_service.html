<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>CRM System Accounts Summary Service &#8212; CRMLXRMS Labs -- distributed businees intelligence solution with predictive modeling  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=c058f7c8" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CRM System Internal Statistics Service" href="internal_satistics_service.html" />
    <link rel="prev" title="CRM System Authorization Service" href="authorization_service.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="crm-system-accounts-summary-service">
<h1>CRM System Accounts Summary Service<a class="headerlink" href="#crm-system-accounts-summary-service" title="Link to this heading">¶</a></h1>
<p>The Accounts Summary Service is an integral component of the CRM System, designed to manage and provide a summary of CRM user accounts. This service facilitates various operations related to accounts, including creation, updates, permissions updates, deactivation, and verification. It also supports queries for retrieving account summaries and detailed account information.
The permission synchronization will hapeent through the permission service: after user with the corresponding permission will create the pecific user role with the specific permission assignt the permissions set and the role to the specific user the corresponding repository in the studnet service will be udpated do to inbox event from permission service. This optimisation is required for the not biased http request. However, in this case, the one more problem appears: for the moment the service with permissions is not available there will not be possible to provide any permission update for the specific role. For this time to situation when the new user has been created accured after the Permission Service will be available there should be a check available and additional outbox evnet publiching for such sort of situations. Theoretically, also thie situation should be in qute informative way described in the Permission service of the Administration Concesstion system.</p>
<img alt="Complex Container Diagram of Accounts Summary Service" class="align-center" src="../_images/accounts_summary_service_-_complex_container_diagram.png" />
<section id="api-documentation">
<h2>API Documentation<a class="headerlink" href="#api-documentation" title="Link to this heading">¶</a></h2>
</section>
<section id="commands">
<h2>Commands<a class="headerlink" href="#commands" title="Link to this heading">¶</a></h2>
<p><strong>CreateAccountCommand</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Handles the creation of a new user account within the system.</p></li>
<li><p><strong>Request URL</strong>: <cite>/api/accounts/create</cite></p></li>
<li><p><strong>Method</strong>: <cite>POST</cite></p></li>
<li><p><strong>Request Body</strong>:
- <cite>userId</cite> (string, required): Unique identifier for the user.
- <cite>accountDetails</cite> (object, required): Detailed information about the account (e.g., email, name, etc.).</p></li>
<li><p><strong>Response</strong>:
- <cite>accountId</cite> (string): The ID of the newly created account.
- <cite>message</cite> (string): Confirmation that the account has been created.</p></li>
<li><p><strong>Events Triggered</strong>: <cite>AccountCreatedEvent</cite></p></li>
</ul>
<p><strong>UpdateAccountCommand</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Handles updates to an existing user account’s information.</p></li>
<li><p><strong>Request URL</strong>: <cite>/api/accounts/update</cite></p></li>
<li><p><strong>Method</strong>: <cite>PUT</cite></p></li>
<li><p><strong>Request Body</strong>:
- <cite>accountId</cite> (string, required): The ID of the account to be updated.
- <cite>updatedDetails</cite> (object, required): Updated account information (e.g., new email, name changes, etc.).</p></li>
<li><p><strong>Response</strong>:
- <cite>message</cite> (string): Confirmation that the account has been updated.</p></li>
<li><p><strong>Events Triggered</strong>: <cite>AccountUpdatedEvent</cite></p></li>
</ul>
<p><strong>DeactivateAccountCommand</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Handles the deactivation of an existing user account.</p></li>
<li><p><strong>Request URL</strong>: <cite>/api/accounts/deactivate</cite></p></li>
<li><p><strong>Method</strong>: <cite>POST</cite></p></li>
<li><p><strong>Request Body</strong>:
- <cite>accountId</cite> (string, required): The ID of the account to be deactivated.
- <cite>reason</cite> (string, optional): Reason for deactivation.</p></li>
<li><p><strong>Response</strong>:
- <cite>message</cite> (string): Confirmation that the account has been deactivated.</p></li>
<li><p><strong>Events Triggered</strong>: <cite>AccountDeactivatedEvent</cite></p></li>
</ul>
<p><strong>VerifyAccountCommand</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Handles the verification process of a user account.</p></li>
<li><p><strong>Request URL</strong>: <cite>/api/accounts/verify</cite></p></li>
<li><p><strong>Method</strong>: <cite>POST</cite></p></li>
<li><p><strong>Request Body</strong>:
- <cite>accountId</cite> (string, required): The ID of the account to be verified.
- <cite>verificationDetails</cite> (object, required): Details required for verification (e.g., verification code).</p></li>
<li><p><strong>Response</strong>:
- <cite>message</cite> (string): Confirmation that the account has been verified.</p></li>
<li><p><strong>Events Triggered</strong>: <cite>AccountVerifiedEvent</cite></p></li>
</ul>
</section>
<section id="queries">
<h2>Queries<a class="headerlink" href="#queries" title="Link to this heading">¶</a></h2>
<p><strong>GetAccountSummaryQuery</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Retrieves a summary of a user account.</p></li>
<li><p><strong>Request URL</strong>: <cite>/api/accounts/summary</cite></p></li>
<li><p><strong>Method</strong>: <cite>GET</cite></p></li>
<li><p><strong>Request Parameters</strong>:
- <cite>accountId</cite> (string, required): The ID of the account for which the summary is requested.</p></li>
<li><p><strong>Response</strong>:
- <cite>accountId</cite> (string): The ID of the account.
- <cite>summary</cite> (object): A brief summary of the account, including key details (e.g., account status, creation date).</p></li>
<li><p><strong>Events Triggered</strong>: None</p></li>
</ul>
<p><strong>GetAccountDetailsQuery</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Fetches detailed information about a user account.</p></li>
<li><p><strong>Request URL</strong>: <cite>/api/accounts/details</cite></p></li>
<li><p><strong>Method</strong>: <cite>GET</cite></p></li>
<li><p><strong>Request Parameters</strong>:
- <cite>accountId</cite> (string, required): The ID of the account for which details are requested.</p></li>
<li><p><strong>Response</strong>:
- <cite>accountId</cite> (string): The ID of the account.
- <cite>details</cite> (object): Detailed information about the account, including all associated data (e.g., user profile, activity log).</p></li>
<li><p><strong>Events Triggered</strong>: None</p></li>
</ul>
</section>
<section id="inbox-events">
<h2>Inbox Events<a class="headerlink" href="#inbox-events" title="Link to this heading">¶</a></h2>
<p>The Accounts Summary Service processes the following inbox events:</p>
<p><strong>AccountCreatedEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Emitted after a new account is successfully created.</p></li>
<li><p><strong>Source</strong>: CRM Authorization Service</p></li>
<li><p><strong>Actions</strong>: Notifies the system that a new account has been created, triggering further actions in other services (e.g., Concession Onboarding).</p></li>
</ul>
<p><strong>UserLoggedOutEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: An event that triggers when a user logs out of the system.</p></li>
<li><p><strong>Source</strong>: Authorization Service</p></li>
<li><p><strong>Actions</strong>: Updates the account summary to reflect the user’s last logout time.</p></li>
</ul>
<p><strong>PasswordResetEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: An event that triggers when a user’s password is reset.</p></li>
<li><p><strong>Source</strong>: CRM Authorization Service</p></li>
<li><p><strong>Actions</strong>: Updates the account summary with information about the password reset, including the timestamp and fingerprints any relevant security notes.</p></li>
</ul>
<p><strong>TwoFactorAuthenticationMethodEnabledEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: An event that triggers when a users sets his 2fa to be anabled.</p></li>
<li><p><strong>Source</strong>: CRM Authorization Service</p></li>
<li><p><strong>Actions</strong>: Updates the account summary with information about the 2fa method enabled for the user permission verification, including the timestamps and fingerprints. Also, thie event mey be believed to be redundant, as the infomration about the 2fa verificaition will also be available in the Claims generated from token.</p></li>
</ul>
<p><strong>UserAssignedToPermissionsSetEvent/UserAssignedToRoleEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: And event from the Permission service in the case any manipulation with the user permission service happens.</p></li>
<li><p><strong>Source</strong>: CRM Permission Service</p></li>
<li><p><strong>Actions</strong>: Updates the account summary with information about the specific set of rht user’s permissions, including the timestamp and any relevant security notes. This is crutial for the query of Getting the User Entity with the speicific set of permission user have assigned, which will be updated be the message recieved from Permissions Service. to provide an optimistaion level for the Accounts Summary service in CRM system.</p></li>
</ul>
</section>
<section id="outbox-events">
<h2>Outbox Events<a class="headerlink" href="#outbox-events" title="Link to this heading">¶</a></h2>
<p>The Accounts Summary Service emits the following outbox events:</p>
<p><strong>AccountUpdatedEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Emitted after an account is successfully updated in comparisson to the previous account data.</p></li>
<li><p><strong>Destination</strong>: CRM Event Bus, CRM event Bus, CRM System Leads summary service</p></li>
<li><p><strong>Actions</strong>: Notifies the system of the account update, ensuring all related services have the most current account information.</p></li>
</ul>
<p><strong>AccountDeactivatedEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Emitted after an account is deactivated.</p></li>
<li><p><strong>Destination</strong>: CRM Event Bus, CRM System Leads summary service</p></li>
<li><p><strong>Actions</strong>: Notifies the system and associated services that the account has been deactivated, triggering any necessary follow-up actions.</p></li>
</ul>
<p><strong>AccountVerifiedEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Emitted after an account is verified.</p></li>
<li><p><strong>Destination</strong>: CRM Event Bus, CRM System</p></li>
<li><p><strong>Actions</strong>: Notifies the Concessions System and CRM that the account has been verified, updating the status across all relevant services.</p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">CRMLXRMS Labs -- distributed businees intelligence solution with predictive modeling</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../administration_concession_system/index.html">Administration Concession System</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">CRM System</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="authorization_service.html">CRM System Authorization Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="authorization_service.html#authorization-service-database-documentation">Authorization Service Database Documentation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">CRM System Accounts Summary Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal_satistics_service.html">CRM System Internal Statistics Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal_satistics_service.html#internal-statistics-service-database-documentation">Internal Statistics Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="external_statistics_service.html">CRM System External Statistics Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="external_statistics_service.html#external-statistics-service-database-documentation">External Statistics Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="payments_service.html">CRM System Payments Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="payments_service.html#payments-service-database-documentation">Payments Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="permissions_service.html">CRM System Permissions Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="permissions_service.html#permissions-service-database-documentation">Permissions Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks_summary_service.html">CRM System Tasks Summary Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks_summary_service.html#tasks-summary-service-database-documentation">Tasks Summary Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="orders_service.html">CRM System Payments Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="orders_service.html#payments-service-database-documentation">Payments Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal_operations_log_service.html">CRM Internal Operations Log Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal_operations_log_service.html#concession-internal-operations-log-service-database-documentation">Concession Internal Operations Log Service Database Documentation</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">CRM System</a><ul>
      <li>Previous: <a href="authorization_service.html" title="previous chapter">CRM System Authorization Service</a></li>
      <li>Next: <a href="internal_satistics_service.html" title="next chapter">CRM System Internal Statistics Service</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Amadeusz Nowak, Andrii Voznesenskyi, Piotr Padamczyk.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.0.2</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/crm_system/accounts_summary_service.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>