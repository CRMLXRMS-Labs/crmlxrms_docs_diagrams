<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        <title>CRM System Accounts Summary Service &mdash; CRMLXRMS Labs -- distributed businees intelligence solution with predictive modeling  documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="../_static/dist/theme.css?v=ea6a6c20" />
            <link rel="index" title="Index" href="../genindex.html" />
            <link rel="search" title="Search" href="../search.html" />
            <link rel="top" title="CRMLXRMS Labs -- distributed businees intelligence solution with predictive modeling  documentation" href="#" />
            <link rel="up" title="CRM System" href="index.html" />
            <link rel="next" title="CRM System Internal Statistics Service" href="internal_satistics_service.html" />
            <link rel="prev" title="CRM System Authorization Service" href="authorization_service.html" />
    </head>
<body>
    <script type="text/javascript" src="../_static/dist/blocking.js"></script>
    <header class="container-fluid bg-primary">
        <a class="btn btn-sm btn-light skip-to-content-link" href="#main">Skip to content</a>
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                    <a href="../index.html"
                        title="Wagtail"
                        class="logo navbar-brand"
                    >
                        <img src="../_static/img/wagtail-logo-new.svg" width="45" height="59" alt="Wagtail"
                            class="logo-img"
                        />
                        Sphinx Wagtail Theme
                    </a>
                
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" class="searchbox mb-6 px-1" role="search">
    <form id="search-form" action="../search.html" autocomplete="off" method="get" role="search">
        <div class="input-group">
            <div class="input-group-prepend">
                <div class="input-group-text border-right-0 bg-white py-3 pl-3 pr-2"><span class="fas fa-search"></span></div>
            </div>
            <input class="form-control py-3 pr-3 pl-1 h-100 border-left-0" type="search" name="q" placeholder="Search documentation" aria-label="Search documentation" id="searchinput" />
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../administration_concession_system/index.html">Administration Concession System</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/authorization_service.html">Administration Concession System Authorization Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/authorization_service.html#authorization-service-database-documentation">Authorization Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/accounts_summary_service.html">Administration Concession System Accounts Summary Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/internal_satistics_service.html">Administration Concession System Internal Statistics Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/internal_satistics_service.html#internal-statistics-service-database-documentation">Internal Statistics Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/external_statistics_service.html">Administration Concession System External Statistics Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/external_statistics_service.html#external-statistics-service-database-documentation">External Statistics Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/payments_service.html">Administration Concession System Payments Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/payments_service.html#payments-service-database-documentation">Payments Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/permissions_service.html">Administration Concession System Permissions Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/permissions_service.html#permissions-service-database-documentation">Permissions Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/tasks_summary_service.html">Administration Concession System Tasks Summary Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/tasks_summary_service.html#tasks-summary-service-database-documentation">Tasks Summary Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/orders_service.html">Administration Concession System Payments Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/orders_service.html#payments-service-database-documentation">Payments Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/internal_operations_log_service.html">Administration Concession Internal Operations Log Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration_concession_system/internal_operations_log_service.html#concession-internal-operations-log-service-database-documentation">Concession Internal Operations Log Service Database Documentation</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">CRM System</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="authorization_service.html">CRM System Authorization Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="authorization_service.html#authorization-service-database-documentation">Authorization Service Database Documentation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">CRM System Accounts Summary Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal_satistics_service.html">CRM System Internal Statistics Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal_satistics_service.html#internal-statistics-service-database-documentation">Internal Statistics Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="external_statistics_service.html">CRM System External Statistics Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="external_statistics_service.html#external-statistics-service-database-documentation">External Statistics Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="payments_service.html">CRM System Payments Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="payments_service.html#payments-service-database-documentation">Payments Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="permissions_service.html">CRM System Permissions Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="permissions_service.html#permissions-service-database-documentation">Permissions Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks_summary_service.html">CRM System Tasks Summary Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks_summary_service.html#tasks-summary-service-database-documentation">Tasks Summary Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="orders_service.html">CRM System Payments Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="orders_service.html#payments-service-database-documentation">Payments Service Database Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal_operations_log_service.html">CRM Internal Operations Log Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal_operations_log_service.html#concession-internal-operations-log-service-database-documentation">Concession Internal Operations Log Service Database Documentation</a></li>
</ul>
</li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="../index.html">Docs</a></li>
            <li class="breadcrumb-item"><a href="index.html">CRM System</a></li>
        <li class="breadcrumb-item active" aria-current="page">CRM System Accounts Summary Service</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="wagtail-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="https://github.com/wagtail/sphinx_wagtail_theme/blob/main/docs/crm_system/accounts_summary_service.rst" rel="nofollow">
        <span class="btn-icon"><span class="fab fa-github"></span></span>
        <span class="btn-text">Edit on GitHub</span>
    </a>
    <a class="btn btn-sm btn-light text-decoration-none" href="../_sources/crm_system/accounts_summary_service.rst.txt" rel="nofollow">
        <span class="btn-icon"><span class="fas fa-code"></span></span>
        <span class="btn-text">View source</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main" id="main">
    <section id="crm-system-accounts-summary-service">
<h1>CRM System Accounts Summary Service<a class="headerlink" href="#crm-system-accounts-summary-service" title="Link to this heading">¶</a></h1>
<p>The Accounts Summary Service is an integral component of the CRM System, designed to manage and provide a summary of CRM user accounts. This service facilitates various operations related to accounts, including creation, updates, permissions updates, deactivation, and verification. It also supports queries for retrieving account summaries and detailed account information.
The permission synchronization will hapeent through the permission service: after user with the corresponding permission will create the pecific user role with the specific permission assignt the permissions set and the role to the specific user the corresponding repository in the studnet service will be udpated do to inbox event from permission service. This optimisation is required for the not biased http request. However, in this case, the one more problem appears: for the moment the service with permissions is not available there will not be possible to provide any permission update for the specific role. For this time to situation when the new user has been created accured after the Permission Service will be available there should be a check available and additional outbox evnet publiching for such sort of situations. Theoretically, also thie situation should be in qute informative way described in the Permission service of the Administration Concesstion system.</p>
<img alt="Complex Container Diagram of Accounts Summary Service" class="align-center" src="../_images/accounts_summary_service_-_complex_container_diagram.png" />
<section id="api-documentation">
<h2>API Documentation<a class="headerlink" href="#api-documentation" title="Link to this heading">¶</a></h2>
</section>
<section id="commands">
<h2>Commands<a class="headerlink" href="#commands" title="Link to this heading">¶</a></h2>
<p><strong>CreateAccountCommand</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Handles the creation of a new user account within the system.</p></li>
<li><p><strong>Request URL</strong>: <cite>/api/accounts/create</cite></p></li>
<li><p><strong>Method</strong>: <cite>POST</cite></p></li>
<li><p><strong>Request Body</strong>:
- <cite>userId</cite> (string, required): Unique identifier for the user.
- <cite>accountDetails</cite> (object, required): Detailed information about the account (e.g., email, name, etc.).</p></li>
<li><p><strong>Response</strong>:
- <cite>accountId</cite> (string): The ID of the newly created account.
- <cite>message</cite> (string): Confirmation that the account has been created.</p></li>
<li><p><strong>Events Triggered</strong>: <cite>AccountCreatedEvent</cite></p></li>
</ul>
<p><strong>UpdateAccountCommand</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Handles updates to an existing user account’s information.</p></li>
<li><p><strong>Request URL</strong>: <cite>/api/accounts/update</cite></p></li>
<li><p><strong>Method</strong>: <cite>PUT</cite></p></li>
<li><p><strong>Request Body</strong>:
- <cite>accountId</cite> (string, required): The ID of the account to be updated.
- <cite>updatedDetails</cite> (object, required): Updated account information (e.g., new email, name changes, etc.).</p></li>
<li><p><strong>Response</strong>:
- <cite>message</cite> (string): Confirmation that the account has been updated.</p></li>
<li><p><strong>Events Triggered</strong>: <cite>AccountUpdatedEvent</cite></p></li>
</ul>
<p><strong>DeactivateAccountCommand</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Handles the deactivation of an existing user account.</p></li>
<li><p><strong>Request URL</strong>: <cite>/api/accounts/deactivate</cite></p></li>
<li><p><strong>Method</strong>: <cite>POST</cite></p></li>
<li><p><strong>Request Body</strong>:
- <cite>accountId</cite> (string, required): The ID of the account to be deactivated.
- <cite>reason</cite> (string, optional): Reason for deactivation.</p></li>
<li><p><strong>Response</strong>:
- <cite>message</cite> (string): Confirmation that the account has been deactivated.</p></li>
<li><p><strong>Events Triggered</strong>: <cite>AccountDeactivatedEvent</cite></p></li>
</ul>
<p><strong>VerifyAccountCommand</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Handles the verification process of a user account.</p></li>
<li><p><strong>Request URL</strong>: <cite>/api/accounts/verify</cite></p></li>
<li><p><strong>Method</strong>: <cite>POST</cite></p></li>
<li><p><strong>Request Body</strong>:
- <cite>accountId</cite> (string, required): The ID of the account to be verified.
- <cite>verificationDetails</cite> (object, required): Details required for verification (e.g., verification code).</p></li>
<li><p><strong>Response</strong>:
- <cite>message</cite> (string): Confirmation that the account has been verified.</p></li>
<li><p><strong>Events Triggered</strong>: <cite>AccountVerifiedEvent</cite></p></li>
</ul>
</section>
<section id="queries">
<h2>Queries<a class="headerlink" href="#queries" title="Link to this heading">¶</a></h2>
<p><strong>GetAccountSummaryQuery</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Retrieves a summary of a user account.</p></li>
<li><p><strong>Request URL</strong>: <cite>/api/accounts/summary</cite></p></li>
<li><p><strong>Method</strong>: <cite>GET</cite></p></li>
<li><p><strong>Request Parameters</strong>:
- <cite>accountId</cite> (string, required): The ID of the account for which the summary is requested.</p></li>
<li><p><strong>Response</strong>:
- <cite>accountId</cite> (string): The ID of the account.
- <cite>summary</cite> (object): A brief summary of the account, including key details (e.g., account status, creation date).</p></li>
<li><p><strong>Events Triggered</strong>: None</p></li>
</ul>
<p><strong>GetAccountDetailsQuery</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Fetches detailed information about a user account.</p></li>
<li><p><strong>Request URL</strong>: <cite>/api/accounts/details</cite></p></li>
<li><p><strong>Method</strong>: <cite>GET</cite></p></li>
<li><p><strong>Request Parameters</strong>:
- <cite>accountId</cite> (string, required): The ID of the account for which details are requested.</p></li>
<li><p><strong>Response</strong>:
- <cite>accountId</cite> (string): The ID of the account.
- <cite>details</cite> (object): Detailed information about the account, including all associated data (e.g., user profile, activity log).</p></li>
<li><p><strong>Events Triggered</strong>: None</p></li>
</ul>
</section>
<section id="inbox-events">
<h2>Inbox Events<a class="headerlink" href="#inbox-events" title="Link to this heading">¶</a></h2>
<p>The Accounts Summary Service processes the following inbox events:</p>
<p><strong>AccountCreatedEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Emitted after a new account is successfully created.</p></li>
<li><p><strong>Source</strong>: CRM Authorization Service</p></li>
<li><p><strong>Actions</strong>: Notifies the system that a new account has been created, triggering further actions in other services (e.g., Concession Onboarding).</p></li>
</ul>
<p><strong>UserLoggedOutEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: An event that triggers when a user logs out of the system.</p></li>
<li><p><strong>Source</strong>: Authorization Service</p></li>
<li><p><strong>Actions</strong>: Updates the account summary to reflect the user’s last logout time.</p></li>
</ul>
<p><strong>PasswordResetEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: An event that triggers when a user’s password is reset.</p></li>
<li><p><strong>Source</strong>: CRM Authorization Service</p></li>
<li><p><strong>Actions</strong>: Updates the account summary with information about the password reset, including the timestamp and fingerprints any relevant security notes.</p></li>
</ul>
<p><strong>TwoFactorAuthenticationMethodEnabledEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: An event that triggers when a users sets his 2fa to be anabled.</p></li>
<li><p><strong>Source</strong>: CRM Authorization Service</p></li>
<li><p><strong>Actions</strong>: Updates the account summary with information about the 2fa method enabled for the user permission verification, including the timestamps and fingerprints. Also, thie event mey be believed to be redundant, as the infomration about the 2fa verificaition will also be available in the Claims generated from token.</p></li>
</ul>
<p><strong>UserAssignedToPermissionsSetEvent/UserAssignedToRoleEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: And event from the Permission service in the case any manipulation with the user permission service happens.</p></li>
<li><p><strong>Source</strong>: CRM Permission Service</p></li>
<li><p><strong>Actions</strong>: Updates the account summary with information about the specific set of rht user’s permissions, including the timestamp and any relevant security notes. This is crutial for the query of Getting the User Entity with the speicific set of permission user have assigned, which will be updated be the message recieved from Permissions Service. to provide an optimistaion level for the Accounts Summary service in CRM system.</p></li>
</ul>
</section>
<section id="outbox-events">
<h2>Outbox Events<a class="headerlink" href="#outbox-events" title="Link to this heading">¶</a></h2>
<p>The Accounts Summary Service emits the following outbox events:</p>
<p><strong>AccountUpdatedEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Emitted after an account is successfully updated in comparisson to the previous account data.</p></li>
<li><p><strong>Destination</strong>: CRM Event Bus, CRM event Bus, CRM System Leads summary service</p></li>
<li><p><strong>Actions</strong>: Notifies the system of the account update, ensuring all related services have the most current account information.</p></li>
</ul>
<p><strong>AccountDeactivatedEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Emitted after an account is deactivated.</p></li>
<li><p><strong>Destination</strong>: CRM Event Bus, CRM System Leads summary service</p></li>
<li><p><strong>Actions</strong>: Notifies the system and associated services that the account has been deactivated, triggering any necessary follow-up actions.</p></li>
</ul>
<p><strong>AccountVerifiedEvent</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: Emitted after an account is verified.</p></li>
<li><p><strong>Destination</strong>: CRM Event Bus, CRM System</p></li>
<li><p><strong>Actions</strong>: Notifies the Concessions System and CRM that the account has been verified, updating the status across all relevant services.</p></li>
</ul>
</section>
</section>

</main>
                        <nav aria-label="Page navigation" class="py-4 my-5 clearfix font-weight-bold border-top">
    <a class="float-left" href="authorization_service.html" title="Previous">
        <span aria-hidden="true">←&nbsp;</span>CRM System Authorization Service
    </a>
    <a class="float-right" href="internal_satistics_service.html" title="Next">
        CRM System Internal Statistics Service <span aria-hidden="true">&nbsp;→</span>
    </a>
</nav>
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">CRM System Accounts Summary Service</a><ul>
<li><a class="reference internal" href="#api-documentation">API Documentation</a></li>
<li><a class="reference internal" href="#commands">Commands</a></li>
<li><a class="reference internal" href="#queries">Queries</a></li>
<li><a class="reference internal" href="#inbox-events">Inbox Events</a></li>
<li><a class="reference internal" href="#outbox-events">Outbox Events</a></li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
                <nav aria-label="Footer">
                    <ul class="nav justify-content-center mb-2">
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/features/">Features</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/about-wagtail/"> About Wagtail</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/services/"> Services</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/blog/"> Blog</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/packages/"> Packages</a></li>
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="https://wagtail.org/developers/"> Developers</a></li>
                        
                    </ul>
                </nav>
            
            <div class="text-center">
                <p style="display: none">
                    <a class="text-light" href="https://github.com/wagtail/sphinx_wagtail_theme" rel="nofollow" target="_blank">
                        Wagtail Sphinx Theme 6.3.0
                    </a>
                </p>
            </div>
            <div class="text-center">
                    &copy; Copyright 2024, Amadeusz Nowak, Andrii Voznesenskyi, Piotr Padamczyk
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script type="text/javascript" src="../_static/dist/theme.js"></script>
        <script type="text/javascript" src="../_static/dist/vendor.js"></script>
        <script type="text/javascript" src="../_static/searchtools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() { Search.loadIndex("../searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>