%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{CRMLXRMS Labs}
\date{Aug 08, 2024}
\release{}
\author{Amadeusz Nowak, Andrii Voznesenskyi, Piotr Padamczyk}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxAtStartPar
Add your content using \sphinxcode{\sphinxupquote{reStructuredText}} syntax. See the
\sphinxhref{https://www.sphinx-doc.org/en/master/usage/restructuredtext/index.html}{reStructuredText}
documentation for details.

\sphinxstepscope


\chapter{Administration Concession System}
\label{\detokenize{administration_concession_system/index:administration-concession-system}}\label{\detokenize{administration_concession_system/index::doc}}
\sphinxstepscope


\section{Authorization Service}
\label{\detokenize{administration_concession_system/authorization_service:authorization-service}}\label{\detokenize{administration_concession_system/authorization_service::doc}}
\sphinxAtStartPar
The Authorization Microservice is a core component of the Administration Concession System. It handles authentication, authorization, and user management processes, which are essential for maintaining secure access and operational control. This microservice also integrates with the CRM system to share user data and operational events.

\noindent{\hspace*{\fill}\sphinxincludegraphics{{authorization_microservice_-_detailed_container_diagram_with_registerconcessioncommand}.png}\hspace*{\fill}}


\subsection{API Documentation}
\label{\detokenize{administration_concession_system/authorization_service:api-documentation}}

\subsection{Commands}
\label{\detokenize{administration_concession_system/authorization_service:commands}}
\sphinxAtStartPar
\sphinxstylestrong{UserLoginCommand}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Initiates the process of logging a user into the system.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/auth/login}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{POST}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Body}:
\sphinxhyphen{} \sphinxtitleref{username} (string, required): The username of the user.
\sphinxhyphen{} \sphinxtitleref{password} (string, required): The password of the user.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{token} (string): A JWT token for authenticated sessions.
\sphinxhyphen{} \sphinxtitleref{expiresIn} (int): Expiration time of the token in seconds.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: \sphinxtitleref{UserLoggedInEvent}

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{UserLogoutCommand}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Initiates the process of logging a user out of the system.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/auth/logout}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{POST}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Body}: None

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{message} (string): Confirmation message that the user has been logged out.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: \sphinxtitleref{UserLoggedOutEvent}

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{ResetPasswordCommand}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Resets the password for a user’s account.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/auth/reset\sphinxhyphen{}password}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{POST}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Body}:
\sphinxhyphen{} \sphinxtitleref{email} (string, required): The email associated with the user’s account.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{message} (string): Confirmation that a password reset email has been sent.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: \sphinxtitleref{PasswordResetEvent}

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Enable2FACommand}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Enables Two\sphinxhyphen{}Factor Authentication (2FA) for a user’s account.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/auth/enable\sphinxhyphen{}2fa}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{POST}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Body}:
\sphinxhyphen{} \sphinxtitleref{userId} (string, required): The ID of the user enabling 2FA.
\sphinxhyphen{} \sphinxtitleref{token} (string, required): The 2FA token generated by the user’s authenticator app.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{message} (string): Confirmation that 2FA has been enabled.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: \sphinxtitleref{TwoFactorEnabledEvent}

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Disable2FACommand}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Disables Two\sphinxhyphen{}Factor Authentication (2FA) for a user’s account.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/auth/disable\sphinxhyphen{}2fa}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{POST}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Body}:
\sphinxhyphen{} \sphinxtitleref{userId} (string, required): The ID of the user disabling 2FA.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{message} (string): Confirmation that 2FA has been disabled.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: \sphinxtitleref{TwoFactorDisabledEvent}

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{VerifyEmailCommand}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Initiates the process of verifying a user’s email address.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/auth/verify\sphinxhyphen{}email}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{POST}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Body}:
\sphinxhyphen{} \sphinxtitleref{userId} (string, required): The ID of the user verifying their email.
\sphinxhyphen{} \sphinxtitleref{emailToken} (string, required): The token sent to the user’s email.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{message} (string): Confirmation that the email has been verified.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: \sphinxtitleref{EmailVerifiedEvent}, \sphinxtitleref{EmailVerificationFailedEvent}

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{RegisterConcessionCommand}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Registers a new concession within the system.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/auth/register\sphinxhyphen{}concession}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{POST}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Body}:
\sphinxhyphen{} \sphinxtitleref{concessionName} (string, required): The name of the concession.
\sphinxhyphen{} \sphinxtitleref{adminEmail} (string, required): The email of the concession’s administrator.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{message} (string): Confirmation that the concession has been registered.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: \sphinxtitleref{ConcessionRegisteredEvent}

\end{itemize}


\subsection{Queries}
\label{\detokenize{administration_concession_system/authorization_service:queries}}
\sphinxAtStartPar
\sphinxstylestrong{GetUserPermissionsQuery}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Retrieves the permissions associated with a user.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/auth/get\sphinxhyphen{}user\sphinxhyphen{}permissions}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{GET}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Parameters}:
\sphinxhyphen{} \sphinxtitleref{userId} (string, required): The ID of the user whose permissions are being retrieved.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{permissions} (array of strings): A list of permissions associated with the user.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{GetUserDetailsQuery}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Fetches the details of a specific user.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/auth/get\sphinxhyphen{}user\sphinxhyphen{}details}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{GET}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Parameters}:
\sphinxhyphen{} \sphinxtitleref{userId} (string, required): The ID of the user whose details are being fetched.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{userId} (string): The ID of the user.
\sphinxhyphen{} \sphinxtitleref{username} (string): The username of the user.
\sphinxhyphen{} \sphinxtitleref{email} (string): The email of the user.
\sphinxhyphen{} \sphinxtitleref{roles} (array of strings): A list of roles assigned to the user.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Get2FAStatusQuery}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Retrieves the 2FA (Two\sphinxhyphen{}Factor Authentication) status of a user.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/auth/get\sphinxhyphen{}2fa\sphinxhyphen{}status}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{GET}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Parameters}:
\sphinxhyphen{} \sphinxtitleref{userId} (string, required): The ID of the user whose 2FA status is being retrieved.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{is2FAEnabled} (boolean): Indicates whether 2FA is enabled for the user.

\end{itemize}


\subsection{Inbox Events}
\label{\detokenize{administration_concession_system/authorization_service:inbox-events}}
\sphinxAtStartPar
The Authorization Microservice processes the following inbox events:

\sphinxAtStartPar
\sphinxstylestrong{ChangeUserRightsEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: An event that triggers when a user’s rights are changed within the CRM system.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Source}: CRM System \textendash{} Leads summary/managenent service (External CRM event bus brigged to Administration concession system).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Updates the user’s permissions within the Administration Concession System to reflect the changes made in the CRM system.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{BlockUserAccessEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: An event that triggers when a user is blocked or suspended in the CRM system.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Source}: CRM System \textendash{} Leads summary/managenent service  (External CRM event bus brigged to Administration concession system).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Immediately revokes the user’s access to the Administration Concession System, ensuring that the block is enforced across systems.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{UnBlockUserAccessEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: An event that triggers when a user is unblocked in case of being suspended in the CRM system.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Source}: CRM System \textendash{} Leads summary/managenent service  (External CRM event bus brigged to Administration concession system).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Immediately revokes the user’s access to the Administration Concession System, ensuring that the block is enforced across systems.

\end{itemize}


\subsection{Outbox Events}
\label{\detokenize{administration_concession_system/authorization_service:outbox-events}}
\sphinxAtStartPar
The Authorization Microservice emits the following outbox events:

\sphinxAtStartPar
\sphinxstylestrong{UserLoggedInEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted after a successful user login within the Administration Concession System.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Destination}: Administration Concession system Internal operation serivce, CRM System Leads Summary Service (leads hub connector service), CRM GRPC intergnal operations service.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Notifies the Administration Concession Administrator user and CRM system user of the user’s login, updates session details.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{User2FaAccessTokenGenerated}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted after a successful user login within the password and login to  the Administration Concession System but having the 2fa enabled.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Destination}: Administration Concession system Notification service, Administration Concession System Internal Operations service.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Required Noitification service Event Emition to pass the token generated back to User trying to sign\sphinxhyphen{}in, Notify Administration of Concession system of having the user trying to access the system with 2fa token.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{UserLoggedOutEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted after a user logs out within the Administration Concession System.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Destination}: Administration Concession system Accouns summary service, Administration Concession System Internal Operations Service, CRM Internal Operaions service.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Notifies the CRM system that the user has logged out (updated leads connection hub), updates session termination details.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{PasswordResetEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted after a user’s password is reset within the Administration Concession System.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Destination}: CRM System Operation service, CRM leads summary service,  Administration Concession system Accouns summary service, Administration Concession System Internal Operations Service, CRM Internal Operaions service.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Notifies the Administration Concession System administrator, CRM system of the specifi user (lead in the case of CRM) password reset, triggers notifications in Administration Concession System Notifcation service (which will be possibly passed to Email Service), and updates security logs.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{TwoFactorEnabledEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted after Two\sphinxhyphen{}Factor Authentication is enabled for a user within the Administration Concession System.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Destination}: CRM System Operation service, CRM leads summary service,  Administration Concession system Accouns summary service, Administration Concession System Internal Operations Service, CRM Internal Operaions service. .

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Notifies the Administration Concession System administrator, CRM system of the specifi user update, updates user security settings, and ensures that 2FA is enforced consistently across AConS.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{TwoFactorDisabledEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted after Two\sphinxhyphen{}Factor Authentication is disabled for a user within the Administration Concession System.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Destination}: CRM System Operation service, CRM leads summary service,  Administration Concession system Accouns summary service, Administration Concession System Internal Operations Service, CRM Internal Operaions service. .

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Notifies the Administration Concession System administrator, CRM system of the specifi user update, updates user security settings, and ensures that 2FA is enforced consistently across AConS.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{EmailVerifiedEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted when a user’s email is successfully verified within the Administration Concession System.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Destination}: CRM System Operation service, CRM leads summary service,  Administration Concession system Accouns summary service, Administration Concession System Internal Operations Service, CRM Internal Operaions service.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Notifies the Administration Concession System administrator, CRM system of specific user (lead) email verification, updates the user’s profile.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{EmailVerificationFailedEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted when a user’s email verification fails within the Administration Concession System.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Destination}: CRM System Operation service, CRM leads summary service, Administration Concession system Accouns summary service, Administration Concession System Internal Operations Service, CRM Internal Operaions service.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Notifies the Administration Concession System administrator, CRM system of specific user (lead) failed verification, updates logs, and marks the user’s email as unverified.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{ConcessionRegisteredEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted after a new concession is registered within the Administration Concession System.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Destination}: CRM System Orders service, Administration Concession system Accouns summary service, Administration Concession System Internal Operations Service, CRM Internal Operaions service.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Notifies the Administration Concession System administrator, CRM system of the new concession, triggers onboarding processes, and syncs concession details across systems.

\end{itemize}

\sphinxstepscope


\section{Accounts Summary Service}
\label{\detokenize{administration_concession_system/accounts_summary_service:accounts-summary-service}}\label{\detokenize{administration_concession_system/accounts_summary_service::doc}}
\sphinxAtStartPar
The Accounts Summary Service is an integral component of the Administration Concession System, designed to manage and provide a summary of administration concession user accounts. This service facilitates various operations related to accounts, including creation, updates, permissions updates, deactivation, and verification. It also supports queries for retrieving account summaries and detailed account information.
The permission synchronization will hapeent through the permission service: after user with the corresponding permission will create the pecific user role with the specific permission assignt the permissions set and the role to the specific user the corresponding repository in the studnet service will be udpated do to inbox event from permission service. This optimisation is required for the not biased http request. However, in this case, the one more problem appears: for the moment the service with permissions is not available there will not be possible to provide any permission update for the specific role. For this time to situation when the new user has been created accured after the Permission Service will be available there should be a check available and additional outbox evnet publiching for such sort of situations. Theoretically, also thie situation should be in qute informative way described in the Permission service of the Administration Concesstion system.

\noindent{\hspace*{\fill}\sphinxincludegraphics{{accounts_summary_service_-_complex_container_diagram}.png}\hspace*{\fill}}


\subsection{API Documentation}
\label{\detokenize{administration_concession_system/accounts_summary_service:api-documentation}}

\subsection{Commands}
\label{\detokenize{administration_concession_system/accounts_summary_service:commands}}
\sphinxAtStartPar
\sphinxstylestrong{CreateAccountCommand}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Handles the creation of a new user account within the system.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/accounts/create}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{POST}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Body}:
\sphinxhyphen{} \sphinxtitleref{userId} (string, required): Unique identifier for the user.
\sphinxhyphen{} \sphinxtitleref{accountDetails} (object, required): Detailed information about the account (e.g., email, name, etc.).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{accountId} (string): The ID of the newly created account.
\sphinxhyphen{} \sphinxtitleref{message} (string): Confirmation that the account has been created.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: \sphinxtitleref{AccountCreatedEvent}

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{UpdateAccountCommand}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Handles updates to an existing user account’s information.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/accounts/update}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{PUT}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Body}:
\sphinxhyphen{} \sphinxtitleref{accountId} (string, required): The ID of the account to be updated.
\sphinxhyphen{} \sphinxtitleref{updatedDetails} (object, required): Updated account information (e.g., new email, name changes, etc.).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{message} (string): Confirmation that the account has been updated.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: \sphinxtitleref{AccountUpdatedEvent}

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{DeactivateAccountCommand}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Handles the deactivation of an existing user account.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/accounts/deactivate}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{POST}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Body}:
\sphinxhyphen{} \sphinxtitleref{accountId} (string, required): The ID of the account to be deactivated.
\sphinxhyphen{} \sphinxtitleref{reason} (string, optional): Reason for deactivation.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{message} (string): Confirmation that the account has been deactivated.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: \sphinxtitleref{AccountDeactivatedEvent}

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{VerifyAccountCommand}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Handles the verification process of a user account.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/accounts/verify}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{POST}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Body}:
\sphinxhyphen{} \sphinxtitleref{accountId} (string, required): The ID of the account to be verified.
\sphinxhyphen{} \sphinxtitleref{verificationDetails} (object, required): Details required for verification (e.g., verification code).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{message} (string): Confirmation that the account has been verified.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: \sphinxtitleref{AccountVerifiedEvent}

\end{itemize}


\subsection{Queries}
\label{\detokenize{administration_concession_system/accounts_summary_service:queries}}
\sphinxAtStartPar
\sphinxstylestrong{GetAccountSummaryQuery}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Retrieves a summary of a user account.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/accounts/summary}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{GET}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Parameters}:
\sphinxhyphen{} \sphinxtitleref{accountId} (string, required): The ID of the account for which the summary is requested.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{accountId} (string): The ID of the account.
\sphinxhyphen{} \sphinxtitleref{summary} (object): A brief summary of the account, including key details (e.g., account status, creation date).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: None

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{GetAccountDetailsQuery}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Fetches detailed information about a user account.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request URL}: \sphinxtitleref{/api/accounts/details}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Method}: \sphinxtitleref{GET}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Request Parameters}:
\sphinxhyphen{} \sphinxtitleref{accountId} (string, required): The ID of the account for which details are requested.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Response}:
\sphinxhyphen{} \sphinxtitleref{accountId} (string): The ID of the account.
\sphinxhyphen{} \sphinxtitleref{details} (object): Detailed information about the account, including all associated data (e.g., user profile, activity log).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Events Triggered}: None

\end{itemize}


\subsection{Inbox Events}
\label{\detokenize{administration_concession_system/accounts_summary_service:inbox-events}}
\sphinxAtStartPar
The Accounts Summary Service processes the following inbox events:

\sphinxAtStartPar
\sphinxstylestrong{AccountCreatedEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted after a new account is successfully created.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Source}: Administration Concession Authorization Service

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Notifies the system that a new account has been created, triggering further actions in other services (e.g., Concession Onboarding).

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{UserLoggedOutEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: An event that triggers when a user logs out of the system.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Source}: Authorization Service

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Updates the account summary to reflect the user’s last logout time.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{PasswordResetEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: An event that triggers when a user’s password is reset.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Source}: Administration Concession Authorization Service

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Updates the account summary with information about the password reset, including the timestamp and fingerprints any relevant security notes.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{TwoFactorAuthenticationMethodEnabledEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: An event that triggers when a users sets his 2fa to be anabled.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Source}: Administration Concession Authorization Service

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Updates the account summary with information about the 2fa method enabled for the user permission verification, including the timestamps and fingerprints. Also, thie event mey be believed to be redundant, as the infomration about the 2fa verificaition will also be available in the Claims generated from token.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{UserAssignedToPermissionsSetEvent/UserAssignedToRoleEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: And event from the Permission service in the case any manipulation with the user permission service happens.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Source}: Administration Concession Permission Service

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Updates the account summary with information about the specific set of rht user’s permissions, including the timestamp and any relevant security notes. This is crutial for the query of Getting the User Entity with the speicific set of permission user have assigned, which will be updated be the message recieved from Permissions Service. to provide an optimistaion level for the Accounts Summary service in administration Concession system.

\end{itemize}


\subsection{Outbox Events}
\label{\detokenize{administration_concession_system/accounts_summary_service:outbox-events}}
\sphinxAtStartPar
The Accounts Summary Service emits the following outbox events:

\sphinxAtStartPar
\sphinxstylestrong{AccountUpdatedEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted after an account is successfully updated in comparisson to the previous account data.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Destination}: Administration Concession Event Bus, CRM event Bus, CRM System Leads summary service

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Notifies the system of the account update, ensuring all related services have the most current account information.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{AccountDeactivatedEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted after an account is deactivated.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Destination}: Administration Concession Event Bus, CRM System Leads summary service

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Notifies the system and associated services that the account has been deactivated, triggering any necessary follow\sphinxhyphen{}up actions.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{AccountVerifiedEvent}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Description}: Emitted after an account is verified.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Destination}: Administration Concession Event Bus, CRM System

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Actions}: Notifies the Concessions System and CRM that the account has been verified, updating the status across all relevant services.

\end{itemize}

\sphinxstepscope


\chapter{CRM System}
\label{\detokenize{crm_system/index:crm-system}}\label{\detokenize{crm_system/index::doc}}


\renewcommand{\indexname}{Index}
\printindex
\end{document}